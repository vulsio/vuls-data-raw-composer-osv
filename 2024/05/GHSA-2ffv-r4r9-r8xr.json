{
	"schema_version": "1.6.0",
	"id": "GHSA-2ffv-r4r9-r8xr",
	"modified": "2024-11-29T05:49:05.109286Z",
	"published": "2024-05-15T21:52:29Z",
	"summary": "Laravel RCE vulnerability in \"cookie\" session driver",
	"details": "Application's using the \"cookie\" session driver were the primary applications affected by this vulnerability. Since we have not yet released a security release for the Laravel 5.5 version of the framework, we recommend that all applications running Laravel 5.5 and earlier do not use the \"cookie\" session driver in their production deployments.\n\nRegarding the vulnerability, applications using the \"cookie\" session driver that were also exposing an encryption oracle via their application were vulnerable to remote code execution. An encryption oracle is a mechanism where arbitrary user input is encrypted and the encrypted string is later displayed or exposed to the user. This combination of scenarios lets the user generate valid Laravel signed encryption strings for any plain-text string, thus allowing them to craft Laravel session payloads when an application is using the \"cookie\" driver.\n\nThis fix prefixes cookie values with an HMAC hash of the cookie's name before encryption and then verifies a matching hash on decryption, making it impossible to craft a valid cookie payload even if an encryption oracle is exposed via the application.",
	"affected": [
		{
			"package": {
				"ecosystem": "Packagist",
				"name": "illuminate/cookie",
				"purl": "pkg:composer/illuminate/cookie"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "4.1.0"
						},
						{
							"fixed": "6.18.31"
						}
					]
				}
			],
			"versions": [
				"5.7.17",
				"5.7.18",
				"5.7.19",
				"v4.1.0",
				"v4.1.1",
				"v4.1.10",
				"v4.1.11",
				"v4.1.12",
				"v4.1.13",
				"v4.1.14",
				"v4.1.15",
				"v4.1.16",
				"v4.1.17",
				"v4.1.18",
				"v4.1.19",
				"v4.1.2",
				"v4.1.20",
				"v4.1.21",
				"v4.1.22",
				"v4.1.23",
				"v4.1.24",
				"v4.1.25",
				"v4.1.26",
				"v4.1.27",
				"v4.1.28",
				"v4.1.29",
				"v4.1.3",
				"v4.1.30",
				"v4.1.4",
				"v4.1.5",
				"v4.1.6",
				"v4.1.7",
				"v4.1.8",
				"v4.1.9",
				"v4.2.0-BETA1",
				"v4.2.1",
				"v4.2.12",
				"v4.2.16",
				"v4.2.17",
				"v4.2.2",
				"v4.2.3",
				"v4.2.4",
				"v4.2.5",
				"v4.2.6",
				"v4.2.7",
				"v4.2.8",
				"v4.2.9",
				"v5.0.0",
				"v5.0.22",
				"v5.0.25",
				"v5.0.26",
				"v5.0.28",
				"v5.0.33",
				"v5.0.4",
				"v5.1.1",
				"v5.1.13",
				"v5.1.16",
				"v5.1.2",
				"v5.1.20",
				"v5.1.22",
				"v5.1.25",
				"v5.1.28",
				"v5.1.30",
				"v5.1.31",
				"v5.1.41",
				"v5.1.6",
				"v5.1.8",
				"v5.2.0",
				"v5.2.19",
				"v5.2.21",
				"v5.2.24",
				"v5.2.25",
				"v5.2.26",
				"v5.2.27",
				"v5.2.28",
				"v5.2.31",
				"v5.2.32",
				"v5.2.37",
				"v5.2.43",
				"v5.2.45",
				"v5.2.6",
				"v5.2.7",
				"v5.3.0",
				"v5.3.16",
				"v5.3.23",
				"v5.3.4",
				"v5.4.0",
				"v5.4.13",
				"v5.4.17",
				"v5.4.19",
				"v5.4.27",
				"v5.4.36",
				"v5.4.9",
				"v5.5.0",
				"v5.5.16",
				"v5.5.17",
				"v5.5.2",
				"v5.5.28",
				"v5.5.33",
				"v5.5.34",
				"v5.5.35",
				"v5.5.36",
				"v5.5.37",
				"v5.5.39",
				"v5.5.40",
				"v5.5.41",
				"v5.5.43",
				"v5.5.44",
				"v5.6.0",
				"v5.6.1",
				"v5.6.10",
				"v5.6.11",
				"v5.6.12",
				"v5.6.13",
				"v5.6.14",
				"v5.6.15",
				"v5.6.16",
				"v5.6.17",
				"v5.6.19",
				"v5.6.2",
				"v5.6.20",
				"v5.6.21",
				"v5.6.22",
				"v5.6.23",
				"v5.6.24",
				"v5.6.25",
				"v5.6.26",
				"v5.6.27",
				"v5.6.28",
				"v5.6.29",
				"v5.6.3",
				"v5.6.30",
				"v5.6.31",
				"v5.6.32",
				"v5.6.33",
				"v5.6.34",
				"v5.6.35",
				"v5.6.36",
				"v5.6.37",
				"v5.6.38",
				"v5.6.39",
				"v5.6.4",
				"v5.6.5",
				"v5.6.6",
				"v5.6.7",
				"v5.6.8",
				"v5.6.9",
				"v5.7.0",
				"v5.7.1",
				"v5.7.10",
				"v5.7.11",
				"v5.7.15",
				"v5.7.2",
				"v5.7.20",
				"v5.7.21",
				"v5.7.22",
				"v5.7.23",
				"v5.7.26",
				"v5.7.27",
				"v5.7.28",
				"v5.7.3",
				"v5.7.4",
				"v5.7.5",
				"v5.7.6",
				"v5.7.7",
				"v5.7.8",
				"v5.7.9",
				"v5.8.0",
				"v5.8.11",
				"v5.8.12",
				"v5.8.14",
				"v5.8.15",
				"v5.8.17",
				"v5.8.18",
				"v5.8.19",
				"v5.8.2",
				"v5.8.20",
				"v5.8.22",
				"v5.8.24",
				"v5.8.27",
				"v5.8.28",
				"v5.8.29",
				"v5.8.3",
				"v5.8.30",
				"v5.8.31",
				"v5.8.32",
				"v5.8.33",
				"v5.8.34",
				"v5.8.35",
				"v5.8.36",
				"v5.8.4",
				"v5.8.8",
				"v5.8.9",
				"v6.0.0",
				"v6.0.1",
				"v6.0.2",
				"v6.0.3",
				"v6.0.4",
				"v6.1.0",
				"v6.10.0",
				"v6.11.0",
				"v6.12.0",
				"v6.13.0",
				"v6.13.1",
				"v6.14.0",
				"v6.15.0",
				"v6.15.1",
				"v6.16.0",
				"v6.17.0",
				"v6.17.1",
				"v6.18.0",
				"v6.18.1",
				"v6.18.10",
				"v6.18.11",
				"v6.18.12",
				"v6.18.13",
				"v6.18.14",
				"v6.18.15",
				"v6.18.16",
				"v6.18.17",
				"v6.18.18",
				"v6.18.19",
				"v6.18.2",
				"v6.18.20",
				"v6.18.21",
				"v6.18.22",
				"v6.18.23",
				"v6.18.24",
				"v6.18.25",
				"v6.18.26",
				"v6.18.27",
				"v6.18.28",
				"v6.18.29",
				"v6.18.3",
				"v6.18.30",
				"v6.18.4",
				"v6.18.5",
				"v6.18.6",
				"v6.18.7",
				"v6.18.8",
				"v6.18.9",
				"v6.2.0",
				"v6.3.0",
				"v6.4.1",
				"v6.5.0",
				"v6.5.1",
				"v6.5.2",
				"v6.6.0",
				"v6.6.1",
				"v6.6.2",
				"v6.7.0",
				"v6.8.0"
			],
			"database_specific": {
				"source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-2ffv-r4r9-r8xr/GHSA-2ffv-r4r9-r8xr.json"
			}
		},
		{
			"package": {
				"ecosystem": "Packagist",
				"name": "illuminate/cookie",
				"purl": "pkg:composer/illuminate/cookie"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "7.0.0"
						},
						{
							"fixed": "7.22.4"
						}
					]
				}
			],
			"versions": [
				"v7.0.0",
				"v7.0.1",
				"v7.0.2",
				"v7.0.3",
				"v7.0.4",
				"v7.0.5",
				"v7.0.6",
				"v7.0.7",
				"v7.0.8",
				"v7.1.0",
				"v7.1.1",
				"v7.1.2",
				"v7.1.3",
				"v7.10.0",
				"v7.10.1",
				"v7.10.2",
				"v7.10.3",
				"v7.11.0",
				"v7.12.0",
				"v7.13.0",
				"v7.14.0",
				"v7.14.1",
				"v7.15.0",
				"v7.16.0",
				"v7.16.1",
				"v7.17.0",
				"v7.17.1",
				"v7.17.2",
				"v7.18.0",
				"v7.19.0",
				"v7.19.1",
				"v7.2.0",
				"v7.2.1",
				"v7.2.2",
				"v7.20.0",
				"v7.21.0",
				"v7.22.0",
				"v7.22.1",
				"v7.22.2",
				"v7.22.3",
				"v7.3.0",
				"v7.4.0",
				"v7.5.0",
				"v7.5.1",
				"v7.5.2",
				"v7.6.0",
				"v7.6.1",
				"v7.6.2",
				"v7.7.0",
				"v7.7.1",
				"v7.8.0",
				"v7.8.1",
				"v7.9.0",
				"v7.9.1",
				"v7.9.2"
			],
			"database_specific": {
				"source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-2ffv-r4r9-r8xr/GHSA-2ffv-r4r9-r8xr.json"
			}
		}
	],
	"references": [
		{
			"type": "WEB",
			"url": "https://blog.laravel.com/laravel-cookie-security-releases"
		},
		{
			"type": "WEB",
			"url": "https://github.com/FriendsOfPHP/security-advisories/blob/master/illuminate/cookie/2020-07-27-1.yaml"
		},
		{
			"type": "PACKAGE",
			"url": "https://github.com/illuminate/cookie"
		}
	],
	"database_specific": {
		"cwe_ids": [
			"CWE-94"
		],
		"github_reviewed": true,
		"github_reviewed_at": "2024-05-15T21:52:29Z",
		"nvd_published_at": null,
		"severity": "CRITICAL"
	}
}
