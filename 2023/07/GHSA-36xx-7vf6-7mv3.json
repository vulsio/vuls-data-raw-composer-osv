{
	"schema_version": "1.6.0",
	"id": "GHSA-36xx-7vf6-7mv3",
	"modified": "2024-02-16T08:21:44.979790Z",
	"published": "2023-07-31T22:00:58Z",
	"aliases": [
		"CVE-2023-32302"
	],
	"summary": "Silverstripe Framework: Members with no password can be created and bypass custom login forms",
	"details": "When a new `Member` record was created in the cms it was possible to set a blank password. If an attacker knows the email address of the user with the blank password then they can attempt to log in using an empty password. The default member authenticator, login form and basic auth all require a non-empty password, however if a custom authentication method is used it may allow a successful login with the empty password. Starting with this release, blank passwords are no no longer allowed when members are created in the CMS. Programatically created `Member` records, such as those used in unit tests, still allow blank passwords. You may have some `Member` records in your system already which have empty passwords. To detect these, you can loop over all `Member` records with `Member::get()` and pass each record into the below method. It might be sensible to create a [`BuildTask`](https://api.silverstripe.org/5/SilverStripe/Dev/BuildTask.html) for this purpose.\n  ```php\n    private function memberHasBlankPassword(Member $member): bool\n    {\n        // skip default admin as this is created programatically\n        if ($member->isDefaultAdmin()) {\n            return false;\n        }\n        // return true if a blank password is valid for this member\n        $authenticator = new MemberAuthenticator();\n        return $authenticator->checkPassword($member, '')->isValid();\n    }\n  ```\n  Once you have identified the records with empty passwords, it's up to you how to handle this. The most sensible way to resolve this is probably to generate a new secure password for each of these members, mark it as immediately expired, and email each affected member (assuming they have a valid email address in the system).\n\nUsers would need to opt-in to insecure behavior by using a configuration which allowed for empty passwords. These configurations are not expected and hence this advisory is primarily informational in nature.\n\nReported by: [Sabina Talipova](https://www.silverstripe.com/about-us/team/?member=sabina-talipova) from Silverstripe and [Christian BÃ¼nte](https://github.com/bimthebam)",
	"severity": [
		{
			"type": "CVSS_V3",
			"score": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:N/A:N"
		}
	],
	"affected": [
		{
			"package": {
				"ecosystem": "Packagist",
				"name": "silverstripe/framework",
				"purl": "pkg:composer/silverstripe/framework"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "3.0.0"
						},
						{
							"fixed": "4.13.14"
						}
					]
				}
			],
			"versions": [
				"3.0.10",
				"3.0.10-rc1",
				"3.0.11",
				"3.0.11-rc1",
				"3.0.12",
				"3.0.13",
				"3.0.14",
				"3.0.2.1",
				"3.0.3",
				"3.0.3-rc1",
				"3.0.3-rc2",
				"3.0.4",
				"3.0.5",
				"3.0.6",
				"3.0.6-rc1",
				"3.0.6-rc2",
				"3.0.7",
				"3.0.7-rc1",
				"3.0.8",
				"3.0.9",
				"3.0.9-rc1",
				"3.1.0",
				"3.1.0-beta1",
				"3.1.0-beta2",
				"3.1.0-beta3",
				"3.1.0-rc1",
				"3.1.0-rc2",
				"3.1.0-rc3",
				"3.1.1",
				"3.1.10",
				"3.1.10-rc1",
				"3.1.10-rc2",
				"3.1.11",
				"3.1.11-rc1",
				"3.1.12",
				"3.1.13",
				"3.1.13-rc1",
				"3.1.14",
				"3.1.14-rc1",
				"3.1.15",
				"3.1.16",
				"3.1.16-rc1",
				"3.1.17",
				"3.1.17-rc1",
				"3.1.17-rc2",
				"3.1.18",
				"3.1.18-rc1",
				"3.1.18-rc2",
				"3.1.19",
				"3.1.19-rc1",
				"3.1.2",
				"3.1.2-rc1",
				"3.1.20",
				"3.1.20-rc1",
				"3.1.20-rc2",
				"3.1.21",
				"3.1.3",
				"3.1.3-rc1",
				"3.1.3-rc2",
				"3.1.4",
				"3.1.4-rc1",
				"3.1.5",
				"3.1.5-rc1",
				"3.1.6",
				"3.1.6-rc1",
				"3.1.6-rc2",
				"3.1.6-rc3",
				"3.1.7",
				"3.1.7-rc1",
				"3.1.8",
				"3.1.9",
				"3.1.9-rc1",
				"3.2.0",
				"3.2.0-beta1",
				"3.2.0-beta2",
				"3.2.0-rc1",
				"3.2.0-rc2",
				"3.2.1",
				"3.2.1-rc1",
				"3.2.1-rc2",
				"3.2.2",
				"3.2.2-rc1",
				"3.2.2-rc2",
				"3.2.3",
				"3.2.3-rc1",
				"3.2.3-rc2",
				"3.2.4",
				"3.2.4-rc1",
				"3.2.5",
				"3.2.5-rc1",
				"3.2.5-rc2",
				"3.2.6",
				"3.3.0",
				"3.3.0-beta1",
				"3.3.0-rc1",
				"3.3.0-rc2",
				"3.3.0-rc3",
				"3.3.1",
				"3.3.1-rc1",
				"3.3.1-rc2",
				"3.3.2",
				"3.3.2-rc1",
				"3.3.3",
				"3.3.3-rc1",
				"3.3.3-rc2",
				"3.3.4",
				"3.4.0",
				"3.4.0-rc1",
				"3.4.1",
				"3.4.1-rc1",
				"3.4.1-rc2",
				"3.4.2",
				"3.4.3",
				"3.4.3-rc1",
				"3.4.4",
				"3.4.4-rc1",
				"3.4.5",
				"3.4.5-rc1",
				"3.4.6",
				"3.4.6-rc1",
				"3.4.6-rc2",
				"3.5.0",
				"3.5.0-rc1",
				"3.5.0-rc2",
				"3.5.0-rc3",
				"3.5.1",
				"3.5.1-rc1",
				"3.5.1-rc2",
				"3.5.2",
				"3.5.2-rc1",
				"3.5.3",
				"3.5.3-rc1",
				"3.5.4",
				"3.5.4-rc1",
				"3.5.5",
				"3.5.5-beta1",
				"3.5.5-beta2",
				"3.5.6",
				"3.5.6-rc1",
				"3.5.7",
				"3.5.8",
				"3.5.8-rc1",
				"3.6.0",
				"3.6.0-beta1",
				"3.6.0-beta2",
				"3.6.0-rc1",
				"3.6.1",
				"3.6.1-alpha2",
				"3.6.2",
				"3.6.2-beta1",
				"3.6.2-beta2",
				"3.6.3",
				"3.6.3-rc2",
				"3.6.4",
				"3.6.5",
				"3.6.6",
				"3.6.6-rc1",
				"3.6.7",
				"3.6.8",
				"3.7.0",
				"3.7.1",
				"3.7.1-rc1",
				"3.7.2",
				"3.7.3",
				"3.7.4",
				"3.7.5",
				"3.7.6",
				"3.7.7",
				"4.0.0",
				"4.0.0-alpha1",
				"4.0.0-alpha2",
				"4.0.0-alpha3",
				"4.0.0-alpha4",
				"4.0.0-alpha5",
				"4.0.0-alpha6",
				"4.0.0-alpha7",
				"4.0.0-beta1",
				"4.0.0-beta2",
				"4.0.0-beta3",
				"4.0.0-beta4",
				"4.0.0-rc1",
				"4.0.0-rc2",
				"4.0.0-rc3",
				"4.0.1",
				"4.0.1-rc1",
				"4.0.2",
				"4.0.3",
				"4.0.4",
				"4.0.5",
				"4.0.6",
				"4.0.7",
				"4.1.0",
				"4.1.0-rc1",
				"4.1.0-rc2",
				"4.1.1",
				"4.1.2",
				"4.1.3",
				"4.1.4",
				"4.1.5",
				"4.10.0",
				"4.10.0-beta1",
				"4.10.0-rc1",
				"4.10.1",
				"4.10.10",
				"4.10.11",
				"4.10.2",
				"4.10.3",
				"4.10.4",
				"4.10.5",
				"4.10.6",
				"4.10.7",
				"4.10.8",
				"4.10.9",
				"4.11.0",
				"4.11.0-beta1",
				"4.11.0-beta2",
				"4.11.0-beta3",
				"4.11.0-rc1",
				"4.11.1",
				"4.11.10",
				"4.11.11",
				"4.11.12",
				"4.11.13",
				"4.11.14",
				"4.11.15",
				"4.11.16",
				"4.11.2",
				"4.11.3",
				"4.11.4",
				"4.11.5",
				"4.11.6",
				"4.11.7",
				"4.11.8",
				"4.11.9",
				"4.12.0",
				"4.12.0-beta1",
				"4.12.0-rc1",
				"4.12.1",
				"4.12.2",
				"4.12.3",
				"4.12.4",
				"4.12.5",
				"4.12.6",
				"4.12.7",
				"4.13.0",
				"4.13.0-beta1",
				"4.13.0-rc1",
				"4.13.1",
				"4.13.10",
				"4.13.11",
				"4.13.12",
				"4.13.13",
				"4.13.2",
				"4.13.3",
				"4.13.4",
				"4.13.5",
				"4.13.6",
				"4.13.7",
				"4.13.8",
				"4.13.9",
				"4.2.0",
				"4.2.0-beta1",
				"4.2.1",
				"4.2.2",
				"4.2.3",
				"4.2.4",
				"4.2.5",
				"4.3.0",
				"4.3.0-rc1",
				"4.3.1",
				"4.3.2",
				"4.3.3",
				"4.3.4",
				"4.3.5",
				"4.4.0",
				"4.4.0-rc1",
				"4.4.1",
				"4.4.2",
				"4.4.3",
				"4.4.4",
				"4.4.5",
				"4.4.6",
				"4.4.7",
				"4.5.0",
				"4.5.0-alpha1",
				"4.5.0-rc1",
				"4.5.0-rc2",
				"4.5.1",
				"4.5.2",
				"4.5.3",
				"4.5.4",
				"4.6.0",
				"4.6.0-beta1",
				"4.6.0-rc1",
				"4.6.1",
				"4.6.2",
				"4.7.0",
				"4.7.0-beta1",
				"4.7.0-rc1",
				"4.7.1",
				"4.7.2",
				"4.7.3",
				"4.7.4",
				"4.8.0",
				"4.8.0-beta1",
				"4.8.0-rc1",
				"4.8.1",
				"4.9.0",
				"4.9.0-alpha1",
				"4.9.0-beta1",
				"4.9.0-rc1",
				"4.9.1",
				"4.9.2",
				"4.9.3",
				"4.9.4"
			],
			"database_specific": {
				"source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-36xx-7vf6-7mv3/GHSA-36xx-7vf6-7mv3.json"
			}
		},
		{
			"package": {
				"ecosystem": "Packagist",
				"name": "silverstripe/framework",
				"purl": "pkg:composer/silverstripe/framework"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "5.0.0"
						},
						{
							"fixed": "5.0.13"
						}
					]
				}
			],
			"versions": [
				"5.0.0",
				"5.0.1",
				"5.0.10",
				"5.0.11",
				"5.0.12",
				"5.0.2",
				"5.0.3",
				"5.0.4",
				"5.0.5",
				"5.0.6",
				"5.0.7",
				"5.0.8",
				"5.0.9"
			],
			"database_specific": {
				"source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-36xx-7vf6-7mv3/GHSA-36xx-7vf6-7mv3.json"
			}
		}
	],
	"references": [
		{
			"type": "WEB",
			"url": "https://github.com/silverstripe/silverstripe-framework/security/advisories/GHSA-36xx-7vf6-7mv3"
		},
		{
			"type": "ADVISORY",
			"url": "https://nvd.nist.gov/vuln/detail/CVE-2023-32302"
		},
		{
			"type": "WEB",
			"url": "https://github.com/github/advisory-database/pull/2575"
		},
		{
			"type": "WEB",
			"url": "https://github.com/silverstripe/silverstripe-framework/commit/7b21b38ac4532d06565dfcefad50540ebd2b50f4"
		},
		{
			"type": "WEB",
			"url": "https://github.com/FriendsOfPHP/security-advisories/blob/master/silverstripe/framework/CVE-2023-32302.yaml"
		},
		{
			"type": "PACKAGE",
			"url": "https://github.com/silverstripe/silverstripe-framework"
		},
		{
			"type": "WEB",
			"url": "https://github.com/silverstripe/silverstripe-framework/releases/tag/4.13.14"
		},
		{
			"type": "WEB",
			"url": "https://github.com/silverstripe/silverstripe-framework/releases/tag/5.0.13"
		},
		{
			"type": "WEB",
			"url": "https://www.silverstripe.org/download/security-releases/CVE-2023-32302"
		}
	],
	"database_specific": {
		"cwe_ids": [
			"CWE-20",
			"CWE-862"
		],
		"github_reviewed": true,
		"github_reviewed_at": "2023-07-31T22:00:58Z",
		"nvd_published_at": "2023-08-01T11:15:09Z",
		"severity": "LOW"
	}
}
